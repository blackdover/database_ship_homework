# ç”¨æˆ·åŒæ­¥è¯´æ˜

## ğŸ”„ é—®é¢˜è¯´æ˜

æœ¬ç³»ç»Ÿä½¿ç”¨**åŒç”¨æˆ·è¡¨**è®¾è®¡ï¼š
1. **Djangoçš„ `auth_user` è¡¨** - ç”¨äºç”¨æˆ·è®¤è¯ï¼ˆç™»å½•éªŒè¯ï¼‰
2. **æ•°æ®åº“çš„ `Users` è¡¨** - ç”¨äºå­˜å‚¨ç”¨æˆ·ä¸šåŠ¡ä¿¡æ¯ï¼ˆæƒé™ã€è§’è‰²ç­‰ï¼‰

å½“æ‚¨ä½¿ç”¨ `python manage.py createsuperuser` åˆ›å»ºç”¨æˆ·æ—¶ï¼Œåªä¼šåœ¨ `auth_user` è¡¨ä¸­åˆ›å»ºè®°å½•ï¼Œä¸ä¼šè‡ªåŠ¨åœ¨ `Users` è¡¨ä¸­åˆ›å»ºå¯¹åº”è®°å½•ï¼Œå¯¼è‡´ç™»å½•åæ˜¾ç¤º"ç”¨æˆ·ä¿¡æ¯ä¸å®Œæ•´"ã€‚

---

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ç”¨æˆ·åŒæ­¥å·¥å…·ï¼ˆæ¨èï¼‰

#### 1. åŒæ­¥å·²å­˜åœ¨çš„Djangoç”¨æˆ·

å¦‚æœæ‚¨å·²ç»ç”¨ `createsuperuser` åˆ›å»ºäº†ç”¨æˆ·ï¼Œåªéœ€åŒæ­¥åˆ° `Users` è¡¨ï¼š

```bash
cd container_management
python sync_user.py sync admin
```

#### 2. åŒæ­¥æ‰€æœ‰Djangoç”¨æˆ·

```bash
cd container_management
python sync_user.py sync-all
```

#### 3. åˆ›å»ºæ–°ç”¨æˆ·å¹¶è‡ªåŠ¨åŒæ­¥ï¼ˆæœ€ä½³æ–¹å¼ï¼‰

ä½¿ç”¨åŒæ­¥å·¥å…·åˆ›å»ºç”¨æˆ·ï¼Œä¼šè‡ªåŠ¨åœ¨ä¸¤ä¸ªè¡¨ä¸­éƒ½åˆ›å»ºè®°å½•ï¼š

```bash
cd container_management
python sync_user.py create admin admin@example.com password123 "ç³»ç»Ÿç®¡ç†å‘˜" --superuser
```

**å‚æ•°è¯´æ˜**ï¼š
- `admin` - ç”¨æˆ·å
- `admin@example.com` - é‚®ç®±
- `password123` - å¯†ç 
- `"ç³»ç»Ÿç®¡ç†å‘˜"` - å…¨åï¼ˆå¯é€‰ï¼‰
- `--superuser` - åˆ›å»ºä¸ºè¶…çº§ç”¨æˆ·ï¼ˆå¯é€‰ï¼‰

---

### æ–¹æ³•äºŒï¼šä½¿ç”¨æ‰¹å¤„ç†è„šæœ¬ï¼ˆWindowsï¼‰

åŒå‡» `åŒæ­¥ç”¨æˆ·.bat` æ–‡ä»¶ï¼ŒæŒ‰æç¤ºæ“ä½œã€‚

---

### æ–¹æ³•ä¸‰ï¼šæ‰‹åŠ¨åŒæ­¥ï¼ˆä¸æ¨èï¼‰

å¦‚æœå¿…é¡»æ‰‹åŠ¨æ“ä½œï¼Œéœ€è¦ï¼š

1. **ç¡®ä¿Djangoç”¨æˆ·å·²åˆ›å»º**
   ```bash
   python manage.py createsuperuser
   ```

2. **åœ¨æ•°æ®åº“ä¸­åˆ›å»ºUsersè¡¨è®°å½•**
   ```sql
   USE box_management;
   
   INSERT INTO Users (Username, Email, Full_Name, Hashed_Password, Is_Active)
   VALUES ('admin', 'admin@example.com', 'ç³»ç»Ÿç®¡ç†å‘˜', '', 1);
   ```

   âš ï¸ **æ³¨æ„**ï¼š`Hashed_Password` å­—æ®µç•™ç©ºå³å¯ï¼Œç³»ç»Ÿä½¿ç”¨Djangoçš„è®¤è¯ã€‚

---

## ğŸ› ï¸ å·¥å…·ä½¿ç”¨è¯´æ˜

### sync_user.py å·¥å…·å‘½ä»¤

#### 1. åŒæ­¥å•ä¸ªç”¨æˆ·
```bash
python sync_user.py sync <ç”¨æˆ·å>
```

**ç¤ºä¾‹**ï¼š
```bash
python sync_user.py sync admin
```

#### 2. åŒæ­¥æ‰€æœ‰ç”¨æˆ·
```bash
python sync_user.py sync-all
```

#### 3. åˆ›å»ºç”¨æˆ·å¹¶åŒæ­¥
```bash
python sync_user.py create <ç”¨æˆ·å> <é‚®ç®±> <å¯†ç > [å…¨å] [--superuser]
```

**ç¤ºä¾‹**ï¼š
```bash
# åˆ›å»ºæ™®é€šç”¨æˆ·
python sync_user.py create operator operator@example.com password123 "æ“ä½œå‘˜"

# åˆ›å»ºè¶…çº§ç”¨æˆ·
python sync_user.py create admin admin@example.com password123 "ç³»ç»Ÿç®¡ç†å‘˜" --superuser
```

---

## ğŸ” éªŒè¯åŒæ­¥ç»“æœ

### 1. æ£€æŸ¥Djangoç”¨æˆ·
```bash
cd container_management
python manage.py shell
```

```python
from django.contrib.auth.models import User
users = User.objects.all()
for u in users:
    print(f'{u.username} - {u.email}')
exit()
```

### 2. æ£€æŸ¥Usersè¡¨
```sql
USE box_management;
SELECT User_ID, Username, Email, Full_Name, Is_Active FROM Users;
```

### 3. ä½¿ç”¨åŒæ­¥å·¥å…·æŸ¥çœ‹
```bash
python sync_user.py sync admin
```

---

## ğŸ“ å®Œæ•´åˆ›å»ºç”¨æˆ·æµç¨‹ï¼ˆæ¨èï¼‰

### æ­¥éª¤1ï¼šåˆ›å»ºDjangoç”¨æˆ·å¹¶åŒæ­¥åˆ°Usersè¡¨

```bash
cd container_management
python sync_user.py create admin admin@example.com yourpassword "ç³»ç»Ÿç®¡ç†å‘˜" --superuser
```

### æ­¥éª¤2ï¼šåˆ†é…æƒé™ï¼ˆå¯é€‰ï¼‰

å¦‚æœç³»ç»Ÿå·²åˆå§‹åŒ–æƒé™ï¼Œå¯ä»¥ä¸ºç”¨æˆ·åˆ†é…æƒé™ï¼š

```sql
USE box_management;

-- è·å–ç”¨æˆ·ID
SELECT User_ID FROM Users WHERE Username = 'admin';

-- åˆ†é…ç®¡ç†å‘˜æƒé™ï¼ˆå‡è®¾ç”¨æˆ·IDä¸º1ï¼‰
INSERT INTO User_Permissions (User_ID, Permission_ID)
SELECT 1, Permission_ID FROM Permissions WHERE Permission_Name = 'ADMIN';
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **é‚®ç®±å”¯ä¸€æ€§**
   - `Users` è¡¨çš„ `Email` å­—æ®µæ˜¯å”¯ä¸€çš„
   - å¦‚æœDjangoç”¨æˆ·æ²¡æœ‰é‚®ç®±ï¼Œå·¥å…·ä¼šè‡ªåŠ¨ç”Ÿæˆ `username@example.com`
   - å¦‚æœé‚®ç®±å†²çªï¼Œä¼šè‡ªåŠ¨æ·»åŠ æ•°å­—åç¼€

2. **å¯†ç å­˜å‚¨**
   - `Users` è¡¨çš„ `Hashed_Password` å­—æ®µç•™ç©º
   - å¯†ç éªŒè¯å®Œå…¨ä½¿ç”¨Djangoçš„ `auth_user` è¡¨
   - ä¸è¦æ‰‹åŠ¨åœ¨ `Users` è¡¨ä¸­å­˜å‚¨å¯†ç 

3. **ç”¨æˆ·ID**
   - Djangoçš„ `auth_user.id` å’Œ `Users.User_ID` æ˜¯ç‹¬ç«‹çš„
   - ç³»ç»Ÿé€šè¿‡ `username` å­—æ®µå…³è”ä¸¤ä¸ªè¡¨
   - ç¡®ä¿ç”¨æˆ·ååœ¨ä¸¤ä¸ªè¡¨ä¸­ä¸€è‡´

4. **è‡ªåŠ¨åŒæ­¥**
   - ç™»å½•æ—¶å¦‚æœæ£€æµ‹åˆ°Djangoç”¨æˆ·å­˜åœ¨ä½†Usersè¡¨ä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨åˆ›å»º
   - ä½†å»ºè®®ä½¿ç”¨å·¥å…·æ‰‹åŠ¨åŒæ­¥ï¼Œæ›´å¯é 

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q: åŒæ­¥åä»ç„¶æ˜¾ç¤º"ç”¨æˆ·ä¸å­˜åœ¨"ï¼Ÿ

**A:** æ£€æŸ¥ï¼š
1. ç”¨æˆ·ååœ¨ä¸¤ä¸ªè¡¨ä¸­æ˜¯å¦å®Œå…¨ä¸€è‡´ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰
2. ä½¿ç”¨ `python sync_user.py sync <ç”¨æˆ·å>` éªŒè¯
3. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å’ŒCookieåé‡æ–°ç™»å½•

### Q: é‚®ç®±å†²çªæ€ä¹ˆåŠï¼Ÿ

**A:** å·¥å…·ä¼šè‡ªåŠ¨å¤„ç†ï¼š
- å¦‚æœé‚®ç®±å·²å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨æ·»åŠ æ•°å­—åç¼€
- ä¾‹å¦‚ï¼š`admin@example.com` â†’ `admin1@example.com`

### Q: å¯ä»¥åˆ é™¤Usersè¡¨è®°å½•å—ï¼Ÿ

**A:** å¯ä»¥ï¼Œä½†æ³¨æ„ï¼š
- åˆ é™¤åç”¨æˆ·å°†æ— æ³•è·å–æƒé™ä¿¡æ¯
- ç™»å½•æ—¶ç³»ç»Ÿä¼šå°è¯•è‡ªåŠ¨åˆ›å»ºï¼Œä½†å¯èƒ½ä¸å®Œæ•´
- å»ºè®®ä½¿ç”¨å·¥å…·é‡æ–°åŒæ­¥

### Q: å¦‚ä½•ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ï¼Ÿ

**A:** 
- **Djangoç”¨æˆ·ä¿¡æ¯**ï¼šåœ¨Django Adminä¸­ä¿®æ”¹ï¼Œæˆ–ä½¿ç”¨ `python manage.py changepassword <ç”¨æˆ·å>`
- **Usersè¡¨ä¿¡æ¯**ï¼šåœ¨Django Adminçš„Usersæ¨¡å‹ä¸­ä¿®æ”¹ï¼Œæˆ–ç›´æ¥ä¿®æ”¹æ•°æ®åº“

---

## ğŸ“ å¿«é€Ÿæ“ä½œ

### å¦‚æœæ‚¨åˆšåˆ›å»ºäº†Djangoç”¨æˆ·ï¼š

```bash
cd container_management
python sync_user.py sync admin
```

### å¦‚æœæ‚¨è¦åˆ›å»ºæ–°ç”¨æˆ·ï¼š

```bash
cd container_management
python sync_user.py create admin admin@example.com password123 "ç³»ç»Ÿç®¡ç†å‘˜" --superuser
```

### å¦‚æœæ‚¨è¦åŒæ­¥æ‰€æœ‰ç”¨æˆ·ï¼š

```bash
cd container_management
python sync_user.py sync-all
```

---

**æœ€åæ›´æ–°**ï¼š2024å¹´

