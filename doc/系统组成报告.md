# 港口集装箱运营系统 - 系统组成报告

## 一、系统概述

港口集装箱运营系统（Terminal Operating System, TOS）是一个基于 Django 框架和 MySQL 数据库开发的企业级管理系统，采用经典的三层架构设计，实现了从数据存储、业务逻辑处理到用户界面展示的完整技术栈。系统以数据库为核心，通过 Django ORM 实现前后端与数据库的集成，为港口集装箱管理提供业务支持。

## 二、数据库层：系统的数据基础

数据库层是整个系统的核心，采用 MySQL 关系型数据库，构建了完整的数据存储体系。系统共设计了 15 个核心业务表，涵盖了港口运营的各个业务环节。主数据表包括相关方表（Party）、港口主数据表（Port_Master）、船舶主数据表（Vessel_Master）、泊位表（Berth）、堆场区表（Yard_Block）、堆场堆栈表（Yard_Stack）、箱位表（Yard_Slot）以及集装箱类型字典表（Container_Type_Dict），这些表构成了系统的基础数据字典。业务数据表则包括集装箱主数据表（Container_Master）、船舶访问表（Vessel_Visit）、订舱单表（Booking）和任务表（Task），记录了日常运营中的动态业务数据。用户权限管理通过用户表（Users）、权限表（Permissions）和用户权限关联表（User_Permissions）实现，支持基本的权限控制。

数据库设计充分体现了关系型数据库的优势，通过外键约束建立了表间的关联关系，确保了数据的引用完整性。系统实现了基本的完整性约束，在数据库层面保证了数据的正确性和一致性。

## 三、后端层：数据库访问与业务逻辑处理

后端层采用 Django 框架构建，通过 Django ORM（对象关系映射）与数据库进行交互。Django Models 层定义了 15 个数据模型，每个模型精确映射到对应的数据库表，模型中的字段类型、约束条件和外键关系都与数据库表结构保持一致。这种设计使得后端代码可以直接通过 ORM 进行数据库操作，例如通过`ContainerMaster.objects.filter()`进行查询，通过`Task.objects.create()`进行数据插入，ORM 会自动将 Python 代码转换为相应的 SQL 语句执行。

在业务逻辑处理方面，系统实现了四个核心功能模块。认证授权模块通过查询 Users 表和 User_Permissions 表实现用户登录验证和权限检查，当用户登录时，系统会查询数据库获取用户信息和权限列表，并将权限信息存储在会话中。管理模块通过 Django Admin 框架实现了对 15 个数据模型的统一管理界面，支持对数据库表的增删改查操作。功能视图模块实现了堆场库存查询、船舶访问管理、任务管理和统计报表等基本功能，这些功能通过查询数据库表获取数据并展示给用户。权限工具模块通过查询用户权限关联表实现权限检查，URL 路由配置模块将不同的 URL 请求路由到相应的视图函数，这些视图函数通过 Django 的数据库连接器与 MySQL 数据库建立连接，执行相应的数据库操作。

## 四、前端层：数据库数据的可视化展示

前端层采用 Django 模板系统构建，通过自定义模板和 Django Admin 界面实现数据的可视化展示。前端不直接操作数据库，而是通过调用后端视图函数获取数据，后端视图函数执行数据库查询后将结果传递给前端模板进行渲染。这种设计模式实现了前后端的分离，前端专注于数据展示和用户交互，后端负责数据处理和数据库访问。

Django Admin 管理界面为 15 个数据模型提供了统一的管理入口，用户可以通过 Web 界面直接对数据库表进行增删改查操作。自定义模板系统包含多个 HTML 模板文件，这些模板通过 Django 模板语法接收后端传递的数据，并将数据渲染为 HTML 页面。用户仪表板根据用户角色显示不同的内容，系统通过查询数据库中的用户权限表判断用户角色，实现基本的权限控制。

## 五、前后端与数据库的集成机制

系统的前后端与数据库通过多层抽象实现了紧密集成。最底层是 MySQL 数据库，存储了所有的业务数据。中间层是 Django ORM 和数据库连接器，ORM 将 Python 对象映射到数据库表，连接器管理数据库连接。上层是 Django 视图函数，这些函数接收 HTTP 请求，执行数据库操作，并将结果返回给前端。最上层是 Django 模板，将数据渲染为 HTML 页面返回给用户浏览器。

当用户在前端发起一个请求时，例如查看堆场库存，请求首先到达 Django 的 URL 路由，路由将请求转发到对应的视图函数。视图函数通过 Django 的数据库连接器获取数据库连接，执行数据库查询，数据库返回查询结果。视图函数将结果封装为 Python 对象，传递给模板进行渲染。模板接收数据后，通过 Django 模板语法生成 HTML 页面，最终返回给用户浏览器显示。

## 六、总结

港口集装箱运营系统通过精心设计的数据库结构、灵活的 Django 后端框架和友好的前端界面，实现了前后端与数据库的有机集成。数据库层提供了完整的数据存储和约束机制，后端层通过 ORM 实现了高效的数据访问，前端层通过模板系统实现了数据的可视化展示。整个系统以数据库为核心，前后端紧密围绕数据库展开，形成了系统的基本架构和核心功能。

## 七、下一步的工作计划

首先，我们将对系统进行全面检查。重点是对现有的数据库设计文档、ER 图及逻辑模式进行最后一次一致性复核，确保所有字段命名规范、类型统一，并修正已发现的模型缺陷。

然后会开展前后端的核心开发工作。后端开发包括在 MySQL 中完成建表，使用 Django 定义 Model 层并编写核心业务的视图函数与 API 接口。前端开发则侧重于搭建页面框架，调用后端接口以实现数据的动态展示与交互。在此开发过程中，我们将逐步加入触发器、存储过程及索引优化，以完成课程设计的技术指标要求。
